\section{Brownian motion}
	\label{sec:chapter1}
	
\subsection{The Brownian motion discovery}


	
In 1827 the Scottish botanist Robert Brown published an article \cite{robert_xxvii_1828} on his observation on the pollen of \textit{Clarkia pulchella} with a lot of details on his thought processes. His experiments were made to understand the flower reproduction, but, as he was looking through the microscope he observed some minute particles ejected from the pollen grains. At first, he thought the goal of this movement was to test the presence of a male organ. In order to test this theory, he extended his observations to Mosses and \textit{Equiseta}, which were drying for a hundred years. However, the fact that this peculiar movement was still observable made him invalidate his theory. Interestingly each time that he encountered a material that he was able to reduce to a fine enough powder to be suspended in water, he observed the same type of motion, although, he never understood its particle's movement.

The difficulty at this time to observe and capture such a movement made the study of what we call today Brownian motion quite difficult and the first theoretical work was actually done by Louis Bachelier in his PhD thesis ``The theory of speculation", where he described a stochastic analysis of the stock and option market. Nowadays, the mathematical description of random movement is still used in the modern financial industry. 

It is finally in 1905 that Albert Einstein theoretically state that ``bodies of microscopically visible size suspended in a liquid will perform movements of such a magnitude that they can be easily observed in a microscope" \cite{einstein_uber_1905}. A remark to make here is that in 1948 Einstein wrote a letter to one of his friend where he stated having deduced the Brownian motion ``from mechanics, without knowing that anyone had already observed anything of the kind" \cite{peter_brownian_nodate}.

It is in 1908 that Jean Perrin published his experimental work on Brownian motion. that way he was able to measure the Avogadro number and prove the kinetic theory that Einstein developed. I would also cite Chaudesaigues and Dabrowski, who helped Perrin to track the particles by hand, half-minutes by half-minutes, for more than 3000 displacements (25 hours) and several particles. This impressive and daunting work is highly detailed in \textit{``Mouvement brownien et molécules"} \cite{perrin_mouvement_1910}. This is partly due the results this work that Perrin received the Nobel award in 1926.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.6]{02_body/chapter1/image/graph_perrin.png}
	\caption{Brownian motion of $1 ~ \mathrm{\mu m}$ particles in water tracked by hand by Jean Perrin and his colleagues. The points are spaced in time by 30 seconds and 16 divisions represents $50 ~ \mathrm{\mu m}$.}
	\label{fig:Perrin_Brownian}
\end{figure}

\subsection{Einstein's Brownian theory}

In this section we will derive the main characteristics of bulk Brownian motion in the manner of Einstein in 1905 by summarizing the section 4 of \cite{einstein_uber_1905}. We will then examine  the random motion of particles suspended in a liquid and its relation to diffusion, caused by thermal molecular motion. We assume that each particle motion is independent of other particles; also the motions of one particle at different times are assumed to be independent of one another provided that the time interval is not too small. Furthermore, we now introduce a time interval $\tau$ which is small compared to the observation time but large enough so that  the displacements in two consecutive time intervals $\tau$ may be taken as independent events. 

For simplicity, we will here look only at the Brownian motion of $n$ particles in 1D along the $x$ axis. In a time interval $\tau$ the position of each individual particle will increase by a displacement $\Delta$, positive or negative. The number of particles $\textnormal{d}n$ experiencing a displacement lying between $\Delta$ and $\Delta + \textnormal{d}\Delta$ in a time interval $\tau$ is written as:

\begin{equation}
	\textnormal{d}n = n\varphi(\Delta)\textnormal{d}\Delta ~,
\end{equation}

where

\begin{equation}
	\int_{-\infty} ^{\infty} \varphi (\Delta)\textnormal{d} \Delta = 1 ~,
	\label{Eq:ein_def_phi}
\end{equation}

and $\varphi$ is nonzero only for very small displacement $\Delta$ and satisfies $\varphi (\Delta) = \varphi (-\Delta)$.

Let $f(x,t)$ be the number of particles per unit volume. From the definition of the function $\varphi(\Delta)$ we can obtain the distribution of particles found at time $ t + \tau$ from their distribution at a time $t$, through:

\begin{equation}
	f(x, t+\tau)\textnormal{d}x = \textnormal{d}x\int_{\Delta = -\infty} ^{\Delta = +\infty} f(x+\Delta, t) \varphi (\Delta) \textnormal{d}\Delta ~.
	\label{Eq:Ein_first}
\end{equation}

Since $\tau$ is very small, we have:

\begin{equation}
	f(x, t+\tau) = f(x,t) + \tau \frac{\partial f}{\partial t} ~.
\end{equation}

On the other side we can Taylor expend $f(x+\Delta, t)$ in powers of $\Delta$ since only small values of $\Delta$ contribute. We obtain:

\begin{equation}
	f(x + \Delta, t) = f(x,t) + \Delta \frac{\partial f(x,t)}{\partial x} + \frac{\Delta ^2}{2!} \frac{\partial ^2 f(x,t)}{\partial x^2} ~... ~\textnormal{ad inf.}
\end{equation}

Putting all together, in Eq.\ref{Eq:Ein_first} we obtain:

\begin{equation}
	f + \frac{\partial f}{\partial t} \tau = f \int_{-\infty}^{+\infty} \varphi(\Delta)\textnormal{d} \Delta + \frac{\partial f}{\partial x} \int_{-\infty}^{+\infty} \Delta \varphi (\Delta)\textnormal{d} \Delta + \frac{\partial ^2 f}{\partial x^2} \int_{-\infty}^{+\infty} \frac{\Delta ^2}{2} \varphi(\Delta)\textnormal{d}\Delta ~...
	\label{Eq:ein_expended}
\end{equation}

On the right-hand side, since $\varphi(x) = \varphi(-x)$ all even terms will vanish, moreover, all the odd terms will be very small compared to the precedent. Taking into account Eq.\ref{Eq:ein_def_phi} and invoking the definition:



\begin{equation}
	\frac{1}{\tau} \int_{-\infty}^{+\infty} \frac{\Delta^2}{2}\varphi(\Delta)\textnormal{d}\Delta = D ~,
\end{equation}

Eq.\ref{Eq:ein_expended} finally becomes:

\begin{equation}
	\frac{\partial f}{\partial t} = D \frac{\partial ^2 f}{\partial x ^2} ~.
	\label{Eq.HeatEquation}
\end{equation}


We can here recognize a partial equation of diffusion with $D$ the diffusion coefficient. We will now initiate the same position $x=0$ for all the particles at $t=0$ as in Fig.\ref{fig:bulkbrown}. $f(x,t)\textnormal{d}x$ denotes the number of particles whose positions have increased between the times  $0$ and $t$  by a quantity lying between $x$ and $x + dx$ such that we must have:

\begin{equation}
	f(x \ne 0, t=0) = 0 \text{ and } \int_{-\infty}^{+\infty}f(x,t)dx = n ~.
\end{equation}

The solution Eq.\ref{Eq.HeatEquation} is then the Green's function of the heat equation in the bulk:


\begin{equation}
	f(x,t) = \frac{1}{\sqrt{4\pi D}} \frac{\exp \left(\frac{-x^2}{4Dt} \right)}{\sqrt{t}} ~.
\end{equation}

From this solution we can see that the mean value of the displacement along the $x$ axis is equal to $0$ and the square root of the arithmetic mean of the squares of displacements (that we commonly call the Root Mean Square Displacement (R\gls{MSD}))  is given by:
\begin{equation}
	\lambda _x = \sqrt{\langle \Delta ^2 \rangle} =  \sqrt{2Dt}.
	\label{Eq:MSD_ein}
\end{equation}

The mean displacement is thus proportional to the square root of time. This result is generally the first behavior that we check when we study Brownian motion. In 3D, the square root of the \gls{MSD} will be given by $\lambda_x \sqrt{3}$.

Previously in his article \cite{einstein_uber_1905}, Einstein had found by writing the thermodynamic equilibrium of a suspension of particles that the diffusion coefficient of a particle should read:

\begin{equation}
	D = \frac{R T}{N_\mathrm{A}}\frac{1}{6\pi \eta a} = \frac{k_\mathrm{B}T}{6 \pi \eta a}
~,
	\label{Eq:D_einstein}
\end{equation}

\nomenclature{$R$}{Gas constant}
\nomenclature{$N_\mathrm{A}$}{Avogrado constant}
\nomenclature{$k_\mathrm{B}$}{Boltzmann Constant}
\nomenclature{$D$}{Diffusion coefficient, see Eq.\ref{Eq:D_einstein}}

with $R$ the gas constant, $T$ the temperature, $N_\mathrm{A}$ the Avogadro number, $\eta$ the fluid viscosity and $k_\mathrm{B}$ the Boltzmann constant. Thus, an experimental measurement of $D$ could lead to a measurement of the Avogadro number since:

\begin{equation}
	N_\mathrm{A} = \frac{t}{\lambda_x^2} \frac{RT}{3\pi \eta a} ~.
\end{equation}

Furthermore, measuring $N_\mathrm{A}$ also gives us the mass of atoms and molecules since the mass of a mole is known; as an example the mass of an oxygen atom will be given by $\frac{16}{N_\mathrm{A}}$ and the mass a water molecule by $\frac{18}{N_\mathrm{A}}$. Finally, Einstein ends up is article \cite{einstein_uber_1905} by writing \textit{``Let us hope that a researcher will soon succeed in solving the problem posed here, which is of such importance in the theory of heat!"}. I would like here to emphasize the importance of solving this problem at the very beginning of the 20th century. At this time two theories about the fundamental matter components existed, one involving energy and a continuum description in terms of field, and the other one, discrete atoms, especially supported by Boltzmann and his kinetic theory of gases, used by Einstein. Due to a lot of theoretical misunderstandings and experimental error scientist such as Svedberg or Henri thought that Einstein's theory was false \cite{genthon_concept_2020} by even suggesting that the statistical properties of Brownian motion were changing with the pH of the solution. It is finally in 1908 that Chaudesaigues and Perrin published all the evidence to prove Einstein's theory mainly by their ability to create particle emulsions of well controlled radii. 

\begin{figure}[!h]
	\centering
	\includegraphics{02_body/chapter1/image/brown_exemple.pdf}
	\caption{Simulation of the bulk Brownian motion of $1 ~ \mathrm{\mu m}$ particles in water. On the top each line represents the trajectory of a Brownian particle over 100 seconds. A total of 100 trajectories or shown. On the bottom, bullets represents the Mean Square Displacement (\gls{MSD}) computed from the simulated trajectories. The black plain line represents Einstein's theory, which is computed from the square of Eq.\ref{Eq:MSD_ein}.}
	\label{fig:bulkbrown}
\end{figure}

\subsection{The Langevin Equation}

In physics we generally describe Brownian motion through a particular Stochastic Differential Equations (\gls{SDE}). This model was introduced in 1908 by Langevin \cite{langevin_sur_1908}, this model is now used by the major part of physicists working on random processes. The Langevin equation for a free colloid reads:

\begin{equation}
	m \textnormal{d}V_t  = - \gamma V_t \textnormal{d}t + \alpha \textnormal{d}B_t ~,
	\label{Eq.langevinEquation}
\end{equation}

\nomenclature{$V_t$}{Velocity of a particle}
\nomenclature{$\alpha$}{Noise amplitude}
\nomenclature{$T$}{Temperature}

with $m$ the mass and $V_t$ the velocity of the particle. This \gls{SDE} is the Newton's second law, relating the particle momentum change on the left-hand side of the equation to forces on the right-hand side. We see that the total force applied on the particle is given by two terms: a friction term, with a Stokes-like fluid friction coefficient $\gamma$, a random force with $\alpha$ that we will detail for a spherical particle, $dBt$ a random noise which has a Gaussian distribution of zero mean thus:

\begin{equation}
	\langle \textnormal{d}B_t \rangle  = 0~,
	\label{Eq.meandbt}
\end{equation}

and variance equal to: 

\begin{equation}
	\langle \textnormal{d}B_t ^2 \rangle = \textnormal{d}t~.
	\label{Eq.meandbt2}
\end{equation}

For a spherical particle the friction term is given by the Stoke's formula: $\gamma = 6\pi \eta a$ with $\eta$ the fluid viscosity and $\alpha$ the particle radius. Thus, we can derive the mean value of the particle velocity as:

\nomenclature{$\eta$}{Fluid viscosity}
\nomenclature{$\gamma$}{Friction coefficient}

\begin{equation}
	\langle  \frac{ \textnormal{d}V_t}{\textnormal{d}t} \rangle = - \frac{\gamma}{m} \langle V_t \rangle \textnormal{d}t  + \frac{\alpha}{m} \langle  \textnormal{d}B_t \rangle ~,
	\label{Eq.langevinsd}
\end{equation}

\nomenclature{$m$}{Mass of a particle}
with the properties of $dB_t$ given by Eq.\ref{Eq.meandbt}, it becomes:

\begin{equation}
	\langle  \textnormal{d}V_t \rangle = - \frac{\gamma}{m} \langle V_t \rangle \textnormal{d}t ~.
	\label{Eq.dvt}
\end{equation}

Moreover, without a loss of generality, the average of a variable $x$, $\langle x \rangle$, is done over a set of $N$ observations $\{x_i\}$ such as:

\begin{equation}
	\langle x \rangle = \frac{1}{N} \sum _{i=1}^N x_i ~,
\end{equation}

one can then show that:

\begin{equation}
	\frac{\textnormal{d}}{\textnormal{d}t}\langle x \rangle = \frac{\textnormal{d}}{ \textnormal{d}t} \left[\frac{1}{N} \sum _{i=1}^N x_i \right] = 
	 \frac{1}{N} \sum _{i=1}^N \frac{\textnormal{d}}{ \textnormal{d}t} x_i = \langle\frac{\textnormal{d}}{\textnormal{d}t} x \rangle ~.
\end{equation}

The latter thus shows that it is possible to invert average value $\langle \cdot \rangle$ and a derivative. Therefor, Eq.\ref{Eq.dvt} becomes:

\begin{equation}
	 \frac{ \textnormal{d}}{\textnormal{d}t}\langle V_t \rangle = - \frac{\gamma}{m} \langle V_t \rangle ~,
\end{equation}

which has a familiar solution:
\begin{equation}
	\langle V_t (t) \rangle =   V_0 \mathrm{e}^{-\frac{\gamma}{m} t}~,
	\label{Eq.int_V_langevin}
\end{equation}

with $V_0$ an initial velocity. This result shows that the average of the velocity should decay to zero with a characteristic time $\tau _\mathrm{B} = \frac{m}{\gamma}$. For instance, the polystyrene particles used during my experiments which are micro-metric we have $\tau_\mathrm{B} \approx 10^{-7}$ s. This means that if we measure the displacements of a particle with a time interval $ \tau  >> \tau _\mathrm{B} $ the displacement can be taken as independent events as it was stated by Einstein. In physical terms, this means that we are in the over-damped regime, in this case the Langevin equation reads:

\begin{equation}
	-\gamma V_t \textnormal{d}t  + \alpha  \textnormal{d}B_t = 0~.
	\label{Eq.overdamped_SDE}
\end{equation}

The experiments done during my thesis used a video camera that can reach a maximum of hundreds frames per second (\gls{fps}) reaching time steps of $\approx 10^{-2}$ s. Therefore, all my work falls into the over damped regime. Before focusing definitely on Eq.\ref{Eq.overdamped_SDE}, we can use Eq.\ref{Eq.langevinsd} to characterize further the unknown coefficient $\alpha$. In order to do so we compute the mean square value of Eq.\ref{Eq.langevinsd}, starting by taking the second order Taylor expansion:


\begin{equation}
	\begin{aligned}
	\textnormal{d}\left(V_t^2\right) &\simeq \frac{\partial V_t ^ 2}{\partial V_t} \textnormal{d} V_t + \frac{1}{2} \frac{\partial ^2 V_t^2}{\partial V_t ^2} \left( \textnormal{d}V_t \right)^2  \\
	& = 2 V_t \textnormal{d}V_t + (\textnormal{d}V_t)^2 \\	
	\end{aligned}
	\label{Eq.compute1}
\end{equation}

combining Eqs.\ref{Eq.langevinEquation} and \ref{Eq.compute1}, we obtain by only keeping  the terms of order $\textnormal{d}t$:

\begin{equation}
	\textnormal{d}\left(V_t^2\right) = 2V_t\left( -\frac{\gamma}{m}V_t\textnormal{d}t + \frac{\alpha}{m}\textnormal{d}B_t  \right) + \frac{\alpha^2}{m^2}\textnormal{d}B_t ^2 ~. 
\end{equation}

Thus, the average value of $ \textnormal{d}(V_t ^2)$ reads:

\begin{equation}
	\langle \textnormal{d}(V_t ^2)\rangle = -2 \frac{\gamma}{m} \langle V_t ^2 \rangle \textnormal dt + 2 \frac{\alpha}{m} \langle V_t \textnormal{d}B_t \rangle + \frac{\alpha^2}{m^2} \langle \textnormal{d}B_t ^2 \rangle~.
	\label{Eq.dvt2}
\end{equation} 

Moreover, since $\textnormal{d}B_t$ is chosen independently of the velocity $V_t$, one can write $\langle V_t \textnormal{d}B_t \rangle $ = $\langle V_t \rangle \langle \textnormal{d}B_t \rangle  =0 $. Taking the latter remark into account and the fact that $\langle \textnormal{d}B_t ^2\rangle = \textnormal{d}t $, Eq.\ref{Eq.dvt2} becomes:

\begin{equation}
	\langle d(V_t^2) \rangle = \left[-2 \frac{\gamma}{m} \langle V_t ^2 \rangle + \frac{\alpha^2}{m^2}\right]\textnormal{d}t~.
\end{equation}

Since equilibrium averages in thermodynamics must become time independent, we have $\langle d(V_t^2) \rangle = 0$, thus:

\begin{equation}
	\langle V_t ^2\rangle = \frac{\alpha ^2}{2 \gamma m}~. 
\end{equation}

Besides, from the equipartition of energy we also know that:

\begin{equation}
	\langle \frac{1}{2} m V_t ^2 \rangle  = \frac{1}{2} k_\mathrm{B} T~.
\end{equation}

The latter equation permits a direct determination of the amplitude of the noise $\alpha$: 

\begin{equation}
	\alpha = \sqrt{2k_\mathrm{B}T \gamma}~.
\end{equation}

The latter result permits to compute the amplitude of the random force in the Langevin equation. Taking the over-damped Langevin equation, it reads:

\begin{equation}
	V_t\textnormal{d}t  = \sqrt{2\frac{k_\mathrm{B}T}{\gamma}} \textnormal{d}B_t 
	\label{Eq.v_t_ovdmp}
\end{equation}

Furthermore, one can write the position of the particule $X_t$ at a time $t$, such as:

\begin{equation}
	X_t = \int _0 ^t V_{t'}dt'~,
	\label{Eq:particle_position}
\end{equation}

where we can suppose at the initial time $t=0$ that $X_0 = 0$. Computing 
$\langle X_t^2 \rangle$ using Eqs.\ref{Eq.v_t_ovdmp},\ref{Eq:particle_position} and \ref{Eq.meandbt2} thus gives:

\begin{equation}
	\langle X_t ^2 \rangle =  2\frac{k_\mathrm{B}T}{\gamma}t = 2Dt
	\label{Eq.xt2}
\end{equation}

By relating $\langle X_t ^2 \rangle$ to the Mean Square Displacement (\gls{MSD}) to the initial position such as:

\begin{equation}
	\textnormal{MSD} = \langle (X_0 - X_ t)^2 \rangle = 	\langle X_t ^2 \rangle~,
\end{equation}


we obtain that the \gls{MSD} should be linear with the time. This result confirms that using the over-damped Langevin equation, leads to the Einstein's result Eq.\ref{Eq:MSD_ein}. Where one can identify the diffusion coefficient of the particle to be $D = k_\mathrm{B}T / \gamma$. The latter identity is called the Stokes-Einstein  relation.


Additionally, the Langevin equation is great to compute correlator such as the velocity correlator $ \langle V_{t'}V_{t''} \rangle$ which the simplest to compute and the one that we will detail below. Indeed, if we use the full Langevin equation, $\langle X_t ^2 \rangle$ can't be that easily computed since $m\textnormal{d} V_t$ does not vanish. We would thus need to rewrite Eq.\ref{Eq.xt2}  using the velocity correletor such as:

\begin{equation}
	\langle X_t ^ 2 \rangle  = \int _0 ^ {t} \int _0 ^{t} \langle V_{t'}V_{t''} \rangle dt'dt'' ~.
	\label{Eq.int_msd}
\end{equation}

Let us now study how the two-point correlator function $ \langle V_{t'}V_{t''} \rangle $, using the full Langevin equation multiplied by $V_0$ and following the same steps as for Eq.\ref{Eq.int_V_langevin}, one  has:

\begin{equation}
	\langle V_t V_0 \rangle = \langle V_0 ^2 \rangle \mathrm{e}^{-t/\tau_{\mathrm{B}}}~.
\end{equation}

As the equilibrium state is invariant under temporal translation and assuming that $V_0$ has an equilibrium steady-state distribution with $\langle V_0^2 \rangle = k_\mathrm{B} T / m$ we have:

\begin{equation}
	\langle V_t V_t' \rangle = \frac{k_\mathrm{B}T}{m} \mathrm{e}^{-|t-t'|/\tau_{\mathrm{B}}}~.
\end{equation}

One can solve Eq.\ref{Eq.int_msd} by splitting the integral in two parts, where $t'>t''$ and $ t' < t''$:

\begin{equation}
	\begin{aligned}
	\langle X_t ^2 \rangle & =    \frac{k_\mathrm{B}T}{m}  \int _0 ^t dt' \int _0 ^{t'} dt'' \mathrm{e} ^ {- |t' - t''| / \tau_\mathrm{B}} = 2 \frac{k_\mathrm{B}T}{\gamma} \left( \int_0 ^t dt' \left[1 - \mathrm{e}^{-t'/\tau_\mathrm{B}} \right] \right) \\
	& = 2 \frac{k_\mathrm{B} T}{\gamma} \left( t - \tau_\mathrm{B} \left[ 1 - \mathrm{e}^{-t/\tau_\mathrm{B}} \right] \right) ~.
	\end{aligned}
\end{equation}

We can extract two results from that equation. At short time $t << \tau_\mathrm{B}$, one has:

\begin{equation}
	\begin{aligned}
	\langle X_t ^2 \rangle & \simeq  2 \frac{k_\mathrm{B} T}{\gamma} \left( t - \tau_\mathrm{B} \left[ 1 - 1 + \frac{t}{\tau_\mathrm{B}} - \frac{t^2}{ 2 \tau_\mathrm{B} ^2}\right]         \right) \\
	& = \frac{k_\mathrm{B} T}{m} t^2 ~.
	\end{aligned}
\end{equation}

This is the ballistic regime. If one can experimentally explore times shorter than $\tau _ \mathrm{B} $ one will then measure the real velocity of the particle. At longer times, $t >> t_\mathrm{B}$, the \gls{MSD} is given by:

\begin{equation}
	\langle X_t ^2 \rangle \simeq 2 \frac{k_\mathrm{B}T}{\gamma} t = 2Dt ~.
\end{equation}

This is the diffusive regime where the \gls{MSD}, as found earlier, Eq.\ref{Eq.xt2} with the over-damped Langevin equation. To study this different results, it can be interesting to simulate the Brownian motion.

\subsubsection{Numerical simulation of bulk Brownian motion}


The Langevin equation is an ordinary differential equation that can easily be numerically simulated in the bulk case. If one approximate the continuous position of a particle $X_t$ at a time $t$ by a discrete-time sequence $x_i$ which is the solution of the equation at a time $t_i = i  \tau$ with $\tau$ being the time step of the simulation. One can then use the Euler method to numerically write $V_t$ as

\begin{equation}
	V_t \simeq \frac{x_i - x_{i-1}}{\tau} ~,
	\label{Eq.vtnum}
\end{equation}

and $\textnormal{d}V_t$ as

\begin{equation}
	\begin{aligned}
	\textnormal{d}V_t &\simeq 
	\frac{
		\frac{x_i - x_{i-1}}{\tau}
		-
		\frac{x_{i-1} - x_{i-2}}{\tau}
	}
	{\tau} \\
	& =  \frac{x_i - 2x_{i - 1} + x_{i-2}}{\tau^2} ~.
	\end{aligned}
	\label{Eq.dvtnum}
\end{equation}

The only term remaining to be computed numerically is the random term $\textnormal{d}B_t$. One can thus replace $\textnormal{d}B_t$ by $w_i$ \footnote{The notation $w$ was choose since in mathematical term, a real valued continuous-time stochastic process such as $\textnormal{d}B_t$ is called a Wiener process in honor of Norbert Wiener \cite{durrett_probability_2019}} a Gaussian distributed random number generated with a mean $\langle w_i \rangle = 0$ and a variance $\langle w_i^2 \rangle  = \tau$. The Probability Density function (PDF) of the Gaussian distribution is thus given by:

\begin{equation}
P(w_i) = \frac{1}{\sqrt{2\pi \tau}}\textnormal{e}^{- \frac{w_i^2}{2\tau}}.
\label{eq.pwi}
\end{equation}



 Such a number can be simply generated with the following Python snippet.
\begin{minted}
	[
	frame=lines,
	framesep=2mm,
	baselinestretch=1.2,
	fontsize=\footnotesize,
	linenos
	]
	{python}
import numpy as np

tau = 0.5  # time step in seconds
wi = np.random.normal(0, np.sqrt(tau))
\end{minted}


In the latter, \mintinline{python}{random.normal()} is a built-in Numpy module that permits the generation of Gaussian distributed random numbers.
Finally, by combining Eqs.\ref{Eq.vtnum}, \ref{Eq.dvtnum} and $w_i$, the full Langevin equation becomes:

\begin{equation}
	m \frac{x_i  - 2x_{i-1} + x_{i-2}}{\tau^2} = -\gamma \frac{x_i - x_{i-1}}{\tau} + \sqrt{2k_\mathrm{B}T\gamma} w_i ~.
\end{equation}

From the latter, one can write $x_i$ as:

\begin{equation}	
	x_i = \frac{2 + \tau /\tau_\mathrm{B}}{1 + \tau / \tau_\mathrm{B} } x_{i-1} 
	- \frac{1}{1 + \tau / \tau_\mathrm{B}}x_{i-2}
	+ \frac{\sqrt{2k_\mathrm{B}T\gamma}}{m(1 + \tau/\tau_\mathrm{B})} \tau ^2 w_i ~,
\end{equation}

where we can observe that we need two initial condition are needed, the two first positions of  the particle. Numerically, those positions could be randomly generated or simply set to $0$, if enough statics are generated it will not play much into the results.



Before, deeping into the actual simulation, it could be interresting to ask ourselve about how long the simulation should be. Indeed, for the different observables' mean value to remain constant we should wait a suffisient amount of time. It is possible to have qualitative approach by generating $N$ number $w_i$ and measuring the resulting \gls{PDF} $P_c(w_i)$ and looking how much we need to increase $N$ to have $P_c(w_i) \simeq P(w_i)$. As we can see on the Fig.\ref{fig:exempleprecisionwi}, for simulation made with  with $\tau = 10^{-3}$ s and $tau = 1$ s, we oberve that as we increase the number of generated numbers $N$, the measured Probability Density Function (PDF), get closer to the real one given by Eq.\ref{eq.pwi}. 

\begin{figure}[h!]
	\centering
	\includegraphics{02_body/chapter1/image/noise_simulation/exemple.pdf}
	\caption{Bullets represents the probability density function of $w_i$, a Gaussian distributed number with a mean value $\langle w_i \rangle$ and a variance $\langle w_i ^2 \rangle  = \tau$. With $\tau$ being the time step over a simulation could be done. The plain black line reprensents a gaussian of zero mean and a $\tau$ variance, Eq.\ref{eq.pwi}. On the first line simulation is done with $\tau = 10^{-3}$ s and $tau = 1$ s on the second one. Each column correspond to a number of draw $N$, from the left to the right $N=10^2, ~10^3, ~10^4$. }
	\label{fig:exempleprecisionwi}
\end{figure}


To have a more quantitative approach, one can compute the Mean squared Error (\gls{MSE})) between the measured \gls{PDF} $P_c{w_i}$ and $P_{w_i}$ as a function of the number of generated numbers $N$, such as:

\begin{equation}
	MSE = \left. \langle (P_c{w_i} - P_{w_i}) ^2\rangle \right|_N
\end{equation}

where the notation $\left. \right|_N$ denotes that $N$ generation has been done.

\begin{figure}
	\centering
	\includegraphics{02_body/chapter1/image/noise_simulation/MSE.pdf}
	\caption{Mean Squared Error (\gls{MSE}) of the pdf measured from a generation of N Gaussian random number $w_i$, and, the actual Gaussian over which the generatio n is done, Eq.\ref{eq.pwi}. The generation is done over a Gaussian which has a mean value $\langle w_i \rangle =0$ and the variance $\langle w_i^2 \rangle = \tau$ ). We explore generation ranging form $N = 10$ to $10^7$ and $\tau = 10^{-4}$ to $10$ s}  
	\label{fig:MSEwi}
\end{figure}







\begin{equation}
	x_i = x_{i-1} + \sqrt{2D}w_i~,
\end{equation}

with $w_i$ a Gaussian distributed random number generated with a mean $\langle w_i \rangle = 0$ and a variance $\langle w_i ^2 \rangle = 
\tau$. A trajectory of $N$ points can thus be simulated with a few lines as in the following Python snippet which was used to create Fig.\ref{fig:bulkbrown}.
\begin{minted}
	[
	frame=lines,
	framesep=2mm,
	baselinestretch=1.2,
	fontsize=\footnotesize,
	linenos
	]
	{python}
import numpy as np

N = 1000  # trajectory length
D = 1  # diffusion coefficient
tau = 0.5  # time step
trajectory = np.cumsum(np.sqrt(2 * D) * np.random.normal(0, np.sqrt(tau), N))
\end{minted}


\subsection{The confined Brownian motion}

We have seen that the bulk Brownian motion is well known and documented for a long time. But, in the real world, the boundaries are not at infinity and could play a role in the process of diffusion. Indeed, it was theorized by H. Faxen \cite{faxen_fredholm_1924} that the presence of a wall would change the Stokes-Einstein relation with a viscosity dependent to the position of the particle. As the particle get closer to a surface, the presence of the non-slip boundary condition make the fluid harder to push, thus increasing the local viscosity of the particle. This variation of the viscosity will be different for orthogonal and parallel displacement to the wall, thus we write respectively $\eta_\bot $ and $\eta_\parallel$ with $\eta_0$ being the fluid viscosity and $z$ the height of the particle:

\begin{equation}
	\eta_\bot = \frac{4}{3} \eta_0 \mathrm{sinh}\beta \sum _{n=1} ^{\infty} \frac{n(n+1)}{{2n-1}{2n+3}}
	\left[
	\frac
	{
		2\mathrm{sinh}(2n + 1)\beta + (2n +1)\mathrm{sinh}2\beta
	}
	{
		4\mathrm{sinh}^2(n + 1 /2)\beta  - (2n+1)^2 \mathrm{sinh}^2 \beta
	}
	-1
	\right] ~,
	\label{Eq:etaz}
\end{equation}

\nomenclature{$\eta_\bot$}{Viscosity orthogonal to a wall, see Eq.\ref{Eq:etaz}}
and 

\begin{equation}
	\eta_\parallel = \eta_0 
	\left[
		1 - \frac{9}{16} \xi + \frac{1}{8}\xi^3 - \frac{45}{256}\xi^4 - \frac{1}{16}\xi^5
	\right]^{-1}~,
	\label{Eq:etax}
\end{equation}
\nomenclature{$\eta_\parallel$}{Viscosity parrallel to a wall, see Eq.\ref{Eq:etax}}

where $\xi = \frac{a}{z+a}$ and $\beta = \mathrm{cosh}^{-1}(\xi)$. It is possible to simplify the form of $\eta_\bot$ by using a Padé approximation, which is correct up to $1\%$ of accuracy:

\begin{equation}
	\eta_\bot = \eta_0 \frac{6z^2 + 9az + 2a^2}{6z^2 + 2az}~.
\end{equation}

Of course, this local viscosity is directly reflected on the diffusive properties of the particle, hence a local diffusion coefficient, which we write:

\begin{equation}
	D_i (z) = \frac{k_\mathrm{B} T}{6\pi\eta_i (z) a}~.
\end{equation}

One of the first experimental measurement of the local diffusion coefficient was brought by Faucheux and Libchaber \cite{faucheux_confined_1994} where they measured the mean diffusion coefficient with various gaps and particle radius their results can be found in the Fig.\ref{fig:libchaber}.

\begin{figure}
	\centering
	\includegraphics{02_body/chapter1/image/libchaber.pdf}
	\caption{Figure extracted from \cite{faucheux_confined_1994}, on the left is the experimental setup used. It is an inverted microscope used in order to track particle of size $2R$ inside a cell of thickness $t$. On the right is their final result, where they measure the diffusion parallel coefficient $D_\bot$ given by Eq.\ref{Eq:etax}, here normalized by $D_0$ the bulk diffusion coefficient as a function of  $\gamma$ a confinement constant $\gamma = (\langle z \rangle -a)/a$. }
	\label{fig:libchaber}
\end{figure}

Another interesting physical aspect to take into account when looking at confined Brownian motion is the potential the particle is lying into. Let's first consider the weight of the particle. Indeed, if the particle density does not match the fluid' one, a spherical particle will lye in a gravity potential given by:

\begin{equation}
	U_g(z) = \frac{4}{3} \pi a^3 (\rho_\mathrm{P} - \rho_\mathrm{F})gz~,
\end{equation}

\nomenclature{$g$}{Gravity constant}
\nomenclature{$\rho_\mathrm{P}$}{Particle density}
\nomenclature{$\rho_\mathrm{F}$}{Fluid density}

that we can rewrite for simplicity

\begin{equation}
	\frac{U_g(z)}{k_\mathrm{B} T} = \frac{z}{\ell_\mathrm{B}}~,
\end{equation}

\nomenclature{$\ell_\mathrm{B}$}{Boltzmann length}
with $\ell_\mathrm{B}$ the Boltzmann length which represents the balance between the kinetic energy and the weight of the particle:

\begin{equation}
	\ell_\mathrm{B} = \frac{k_\mathrm{B} T}{ \frac{4}{3} \pi a^3 \Delta \rho g}~.
\end{equation}

Let's now consider the interactions with the substrate, glass slides when immersed in water do charge negatively as well as polystyrene particles that we use. We will then have repulsive electrostatic interactions between the wall and the particles, the corresponding potential can be written as  \cite{israelachvili_intermolecular_2015}:

\begin{equation}
	\frac{U_\mathrm{elec}(z)}{k_\mathrm{B}T} = B \mathrm{e}^{-z/\ell_\mathrm{D}}~,
\end{equation}

\nomenclature{$B$}{Amplitude of the electrostatic interactions}
\nomenclature{$\ell_\mathrm{D}$}{Debye length}

where $B$ is the amplitude of electrostatic interactions, representing the surface charges and $\ell_\mathrm{D}$ being the Debye length, which is the characteristic length of the electrostatic interactions. The particle is thus lying in a total potential given by:

\begin{equation}
	\frac{U(z)}{k_\mathrm{B}T} =   B \mathrm{e}^{-z/\ell_\mathrm{D}} +  \frac{z}{\ell_\mathrm{B}}~.
\end{equation}

From this total potential one can construct the Gibbs-Boltzmann distribution in position:

\begin{equation}
	P_\mathrm{eq}(z) = A\mathrm{e}^
	{
		\frac{U}{k_\mathrm{B}T}	
	}~,
	\label{Eq:Peq}
\end{equation}

where $A$ is a normalization constant so that $\int P_\mathrm{eq} = 1$. This distribution gives us the probability to find the particle at a height $z$. The exponential decay due to the gravity was first measured by Perrin \cite{perrin_les_2014} by methodically counting through a microscope the number of colloids in suspension as a function on the height. 


\begin{figure}[H]
	\centering
	\includegraphics{02_body/chapter1/image/theorie_chap1.pdf}
	\caption{On the left, plot of the Gibbs-Boltzmann distribution Eq.\ref{Eq:Peq} for $a = 1 ~ \mathrm{\mu m}$, $ B = 4 $, $\ell _\mathrm{D} = 100 ~ \mathrm{nm}$ and $\Delta \rho = 50 ~ \mathrm{kg.m^{-3}}$. On the right, local diffusion coefficient normalized by bulk diffusion coefficient $D_0 = k_\mathrm{B}T/\gamma$, given by Eq.\ref{Eq:etax} and Eq.\ref{Eq:etaz}}.
\end{figure}
